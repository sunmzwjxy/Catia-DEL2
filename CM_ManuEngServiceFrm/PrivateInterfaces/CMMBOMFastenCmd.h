//===================================================================
// COPYRIGHT  2021/02/04
//===================================================================
// CMMBOMFastenCmd.cpp
// Header definition of class CMMBOMFastenCmd
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2021/02/04 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef CMMBOMFastenCmd_H
#define CMMBOMFastenCmd_H

#include "ProcessPlanningService.h"
#include "CATStateCommand.h"

#include "CMMBOMFastenDlg.h"
#include "ProcessPlanningService.h"

#include "CATPathElementAgent.h"

//CATPLMComponentInterfaces 
#include "CATIPLMNavReference.h"
#include "CATIPLMNavOccurrence.h"
#include "CATIPLMNavRepInstance.h"
#include "CATIPLMNavInstance.h"
#include "CATSysBoolean.h"
#include "CATDialogAgent.h"
#include "CATDlgCheckButton.h"

//VisualizationInterfaces 
#include "CATPathElement.h"

//DELPPRProcessItf 
#include "DELPPRProcessNavAccess.h"
#include "DELIPPRProcessNav.h"
#include "DELIPPRProcessAuth.h"
#include "DELPPRProcessAuthAccess.h"

#include "iostream.h"

#include "CATStateCommand.h"

#include "CATPathElementAgent.h"
#include "CATIPLMNavOccurrence.h"
#include "CATIPLMNavRepInstance.h"
#include "CATIPLMNavReference.h"

#include "CATListOfCATUnicodeString.h"
#include "CATListOfInt.h"
//-----------------------------------------------------------------------

struct Fastener {
	CATListOfCATUnicodeString sFastenCollection;
	CATListOfInt nFastenCollection;
	CATListOfCATUnicodeString sFastenSingle;
	CATListOfInt nFastenSingle;
};

class CMMBOMFastenCmd: public CATStateCommand
{
	DeclareResource(CMMBOMFastenCmd, CATStateCommand)
public:
// Standard constructors and destructors
// -------------------------------------
CMMBOMFastenCmd ();
virtual ~CMMBOMFastenCmd ();

//
// TODO: Add your methods for this class here.
//
virtual void     BuildGraph();

virtual CATBoolean OKAction(void *data);

virtual CATBoolean CancelAction(void *data);

CATBoolean ElementSelection(void * data);

void FilterSelectObject();

HRESULT CrateManufacturingFasten(CATUnicodeString sFastenName, CATUnicodeString sFastenVName, CATUnicodeString sFastenDesc);

HRESULT ParseRModelValue();

CATBoolean ChangeFastenPairChkBtn(void *data);

CATBoolean ChangeFastenRemainNumber(void *data);

CATUnicodeString jointPairFastenName(CATUnicodeString sFastenPairList, CATUnicodeString splitChar);

int CalcFastenUsed();

int CalcFastenUsedWebService();

int CalcFastenPairUsedWebService();

void ClearFastenData();
//

private:
	// Copy constructor and equal operator
	// -----------------------------------
	CMMBOMFastenCmd(CMMBOMFastenCmd &);
	CMMBOMFastenCmd& operator=(CMMBOMFastenCmd&);

	CMMBOMFastenDlg * _Panel;

	CATPathElementAgent *_pSelectAgent;

	CATDialogAgent *_OKAgent;
	//CATDialogAgent *_ApplyAgent;
	CATDialogAgent *_CloseAgent;
	CATDialogAgent *_CancleAgent;

	CATBaseUnknown        * _pSelectedElement;
	CATIPLMNavOccurrence  * _pSelectedOccurrence;
	CATIPLMNavRepInstance * _pSelectedRepInstance;
	CATIPLMNavReference   * _pSelectedReference;

	CATDialogTransition * _pDialogTransition;

	CATIPLMNavReference *pManuAssemblyRef;
	CATIPLMNavOccurrence *pManuAssemblyOcc;

	CATIPLMNavReference *pMARootRef;
	CATIPLMNavOccurrence *pMARootOcc;

	CATIPLMNavReference *pProductRef;
	CATIPLMNavOccurrence *pProductOcc;

	CATDlgCombo * pFastenNameCombo;
	CATDlgCheckButton * pCheckFastenPairBtn;
	CATDlgEditor * pRemainNumberEditor;

	CATListOfCATUnicodeString sFastenSingleNameList;
	CATListOfCATUnicodeString sFastenSingleTitleList;
	CATListOfInt sFastenSingleNumberList;

	CATListOfCATUnicodeString sFastenColletionNameList;
	CATListOfCATUnicodeString sFastenColletionTitleList;
	CATListOfInt sFastenColletionNumberList;
	CATListOfInt sFastenColletionIndexList;
	CATListOfCATUnicodeString sFastenColletionIndexNameList;
	CATListOfCATUnicodeString sFastenColletionIndexTitleList;

	CATBoolean bPairAssign;

	int nFastenUsing;
	CATUnicodeString sFastenUsing;

	CATUnicodeString sRModelExternalId;
	CATUnicodeString sRModelRevision;

	int nSelectIndex;
	CATUnicodeString sFastenPartName;

	CATUnicodeString sSelectFastenName;
	CATUnicodeString sSelectFastenTitle;

	CATListOfCATUnicodeString sSelectFastenCollectionName;
	CATListOfCATUnicodeString sSelectFastenCollectionTitle;
};

//-----------------------------------------------------------------------

#endif
