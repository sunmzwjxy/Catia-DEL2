//===================================================================
// COPYRIGHT  2020/09/16
//===================================================================
// CM_CUSProcessPlanAddin.cpp
// Header definition of class CM_CUSProcessPlanAddin
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2020/09/16 Creation: Code generated by the 3DS wizard
//===================================================================

#include "CM_CUSProcessPlanAddin.h"

CATImplementClass(CM_CUSProcessPlanAddin, DataExtension, CATBaseUnknown, CM_CUSProcessPlanAddinLT);

#include "DELIPPRLivePPREditorWkbAddin.h"
//Planning Structure
//#include "TIE_DELIPPRLivePPREditorWkbAddin.h"
//TIE_DELIPPRLivePPREditorWkbAddin(CM_CUSProcessPlanAddin);
//CATImplementBOA(DELIPPRLivePPREditorWkbAddin, CM_CUSProcessPlanAddin);

//workbench Process Definition.   Process Planning
#include "TIE_CATIPPRLiveProcessWkbAddin.h"
TIE_CATIPPRLiveProcessWkbAddin(CM_CUSProcessPlanAddin);


#include "TIE_DNBIPPRNavWkbAddin.h"
TIE_DNBIPPRNavWkbAddin(CM_CUSProcessPlanAddin);


//Manufacturing System Definition  workbench.
#include "TIE_CATIManufacturingSystemDefinitionWorkbenchAddin.h"
TIE_CATIManufacturingSystemDefinitionWorkbenchAddin(CM_CUSProcessPlanAddin);


//#include "TIE_CATIAfrGeneralWksAddin.h"
//TIE_CATIAfrGeneralWksAddin(CM_CUSProcessPlanAddin);

//CATImplementBOA(CATIAfrGeneralWksAddin, CM_CUSProcessPlanAddin);



#include "TIE_IDELWIWkbAddin.h"
TIE_IDELWIWkbAddin(CM_CUSProcessPlanAddin);

//-----------------------------------------------------------------------------
// CM_CUSProcessPlanAddin : constructor
//-----------------------------------------------------------------------------
CM_CUSProcessPlanAddin::CM_CUSProcessPlanAddin():CATBaseUnknown()
{
//
//TODO: Add the constructor code here
//
}

//-----------------------------------------------------------------------------
// CM_CUSProcessPlanAddin : destructor
//-----------------------------------------------------------------------------

CM_CUSProcessPlanAddin::~CM_CUSProcessPlanAddin()
{
//
// TODO: Place code here.
//
}


void CM_CUSProcessPlanAddin::CreateCommands()
{
	
	//创建工位
	CATAfrCommandHeader::CATCreateCommandHeader("CMCreateGWSystemHdr", "ProcessPlanningService",
		"CMCreateGWSystemCmd", (void *)NULL,
		"CMMECommandHeader", CATFrmAvailable);   //CATFrmUnavailable

	//创建站位
	CATAfrCommandHeader::CATCreateCommandHeader("CMCreateZWSystemHdr", "ProcessPlanningService",
		"CMCreateZWSystemCmd", (void *)NULL,
		"CMMECommandHeader", CATFrmAvailable);


	//创建AO
	CATAfrCommandHeader::CATCreateCommandHeader("CMCreateAOSystemHdr", "ProcessPlanningService",
		"CMCreateAOSystemCmd", (void *)NULL,
		"CMMECommandHeader", CATFrmAvailable);

	//CATAfrCommandHeader::CATCreateCommandHeader("CMCreateAOSystemHdr", "ProcessPlanningService", "CMCreateAOSystemCmd", (void *)NULL, "CMMECommandHeader", CATFrmAvailable);

}
CATCmdContainer *CM_CUSProcessPlanAddin::CreateToolbars()
{
	NewAccess(CATCmdContainer, pCMProcessSection, CMProcessSection);

	NewAccess(CATCmdContainer, pCMProcessTlb, CMProcessTlb);
	SetAccessChild(pCMProcessSection, pCMProcessTlb);

	//工位
	NewAccess(CATCmdStarter, pCMCreateGWSystem, CMCreateGWSystem);
	SetAccessCommand(pCMCreateGWSystem, "CMCreateGWSystemHdr");
	SetAccessChild(pCMProcessTlb, pCMCreateGWSystem);

	//站位
	NewAccess(CATCmdStarter, pCMCreateZWSystem, CMCreateZWSystem);
	SetAccessCommand(pCMCreateZWSystem, "CMCreateZWSystemHdr");
	SetAccessNext(pCMCreateGWSystem, pCMCreateZWSystem);

	//AO
	NewAccess(CATCmdStarter, pCMCreateAOSystem, CMCreateAOSystem);
	SetAccessCommand(pCMCreateAOSystem, "CMCreateAOSystemHdr");
	SetAccessNext(pCMCreateZWSystem, pCMCreateAOSystem);

	return pCMProcessSection;


	//NewAccess(CATCmdContainer, pMyToolbar, CMProcessSection);

	//NewAccess(CATCmdContainer, pMyGWTlb, MyGWTlb);
	//SetAccessChild(pMyToolbar, pMyGWTlb);

	//NewAccess(CATCmdStarter, pBasicCmd, BasicCmd);
	//SetAccessCommand(pBasicCmd, "CMCreateAOSystemHdr");
	//SetAccessChild(pMyGWTlb, pBasicCmd);

	////AddToolbarView(pMyToolbar,	1,	Left);		

	//return pMyToolbar;
}


